if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((n=>t.resolve(e()).then((()=>n))),(n=>t.resolve(e()).then((()=>{throw n}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...n){uni.__log__?uni.__log__(e,t,...n):console[e].apply(console,[...n,t])}function n(){return"undefined"!=typeof navigator&&"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}}const o="function"==typeof Proxy;class s{constructor(e,t){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=t;const n={};if(e.settings)for(const r in e.settings){const t=e.settings[r];n[r]=t.defaultValue}const o=`__vue-devtools-plugin-settings__${e.id}`;let s={...n};try{const e=localStorage.getItem(o),t=JSON.parse(e);Object.assign(s,t)}catch(a){}this.fallbacks={getSettings:()=>s,setSettings(e){try{localStorage.setItem(o,JSON.stringify(e))}catch(a){}s=e}},t.on("plugin:settings:set",((e,t)=>{e===this.plugin.id&&this.fallbacks.setSettings(t)})),this.proxiedOn=new Proxy({},{get:(e,t)=>this.target?this.target.on[t]:(...e)=>{this.onQueue.push({method:t,args:e})}}),this.proxiedTarget=new Proxy({},{get:(e,t)=>this.target?this.target[t]:"on"===t?this.proxiedOn:Object.keys(this.fallbacks).includes(t)?(...e)=>(this.targetQueue.push({method:t,args:e,resolve:()=>{}}),this.fallbacks[t](...e)):(...e)=>new Promise((n=>{this.targetQueue.push({method:t,args:e,resolve:n})}))})}async setRealTarget(e){this.target=e;for(const t of this.onQueue)this.target.on[t.method](...t.args);for(const t of this.targetQueue)t.resolve(await this.target[t.method](...t.args))}}function a(e,t){const a=n(),r=n().__VUE_DEVTOOLS_GLOBAL_HOOK__,i=o&&e.enableEarlyProxy;if(!r||!a.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__&&i){const n=i?new s(e,r):null;(a.__VUE_DEVTOOLS_PLUGINS__=a.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:e,setupFn:t,proxy:n}),n&&t(n.proxiedTarget)}else r.emit("devtools-plugin:setup",e,t)}
/*!
   * vuex v4.1.0
   * (c) 2022 Evan You
   * @license MIT
   */var r="store";function i(t){return void 0===t&&(t=null),e.inject(null!==t?t:r)}function c(e,t){Object.keys(e).forEach((function(n){return t(e[n],n)}))}function l(e,t,n){return t.indexOf(e)<0&&(n&&n.prepend?t.unshift(e):t.push(e)),function(){var n=t.indexOf(e);n>-1&&t.splice(n,1)}}function u(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var n=e.state;p(e,n,[],e._modules.root,!0),d(e,n,t)}function d(t,n,o){var s=t._state,a=t._scope;t.getters={},t._makeLocalGettersCache=Object.create(null);var r=t._wrappedGetters,i={},l={},u=e.effectScope(!0);u.run((function(){c(r,(function(n,o){i[o]=function(e,t){return function(){return e(t)}}(n,t),l[o]=e.computed((function(){return i[o]()})),Object.defineProperty(t.getters,o,{get:function(){return l[o].value},enumerable:!0})}))})),t._state=e.reactive({data:n}),t._scope=u,t.strict&&function(t){e.watch((function(){return t._state.data}),(function(){}),{deep:!0,flush:"sync"})}(t),s&&o&&t._withCommit((function(){s.data=null})),a&&a.stop()}function p(e,t,n,o,s){var a=!n.length,r=e._modules.getNamespace(n);if(o.namespaced&&(e._modulesNamespaceMap[r],e._modulesNamespaceMap[r]=o),!a&&!s){var i=f(t,n.slice(0,-1)),c=n[n.length-1];e._withCommit((function(){i[c]=o.state}))}var l=o.context=function(e,t,n){var o=""===t,s={dispatch:o?e.dispatch:function(n,o,s){var a=h(n,o,s),r=a.payload,i=a.options,c=a.type;return i&&i.root||(c=t+c),e.dispatch(c,r)},commit:o?e.commit:function(n,o,s){var a=h(n,o,s),r=a.payload,i=a.options,c=a.type;i&&i.root||(c=t+c),e.commit(c,r,i)}};return Object.defineProperties(s,{getters:{get:o?function(){return e.getters}:function(){return m(e,t)}},state:{get:function(){return f(e.state,n)}}}),s}(e,r,n);o.forEachMutation((function(t,n){!function(e,t,n,o){(e._mutations[t]||(e._mutations[t]=[])).push((function(t){n.call(e,o.state,t)}))}(e,r+n,t,l)})),o.forEachAction((function(t,n){var o=t.root?n:r+n,s=t.handler||t;!function(e,t,n,o){(e._actions[t]||(e._actions[t]=[])).push((function(t){var s,a=n.call(e,{dispatch:o.dispatch,commit:o.commit,getters:o.getters,state:o.state,rootGetters:e.getters,rootState:e.state},t);return(s=a)&&"function"==typeof s.then||(a=Promise.resolve(a)),e._devtoolHook?a.catch((function(t){throw e._devtoolHook.emit("vuex:error",t),t})):a}))}(e,o,s,l)})),o.forEachGetter((function(t,n){!function(e,t,n,o){if(e._wrappedGetters[t])return;e._wrappedGetters[t]=function(e){return n(o.state,o.getters,e.state,e.getters)}}(e,r+n,t,l)})),o.forEachChild((function(o,a){p(e,t,n.concat(a),o,s)}))}function m(e,t){if(!e._makeLocalGettersCache[t]){var n={},o=t.length;Object.keys(e.getters).forEach((function(s){if(s.slice(0,o)===t){var a=s.slice(o);Object.defineProperty(n,a,{get:function(){return e.getters[s]},enumerable:!0})}})),e._makeLocalGettersCache[t]=n}return e._makeLocalGettersCache[t]}function f(e,t){return t.reduce((function(e,t){return e[t]}),e)}function h(e,t,n){var o;return null!==(o=e)&&"object"==typeof o&&e.type&&(n=t,t=e,e=e.type),{type:e,payload:t,options:n}}var g="vuex:mutations",v="vuex:actions",y="vuex",w=0;function E(e,t){a({id:"org.vuejs.vuex",app:e,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:["vuex bindings"]},(function(n){n.addTimelineLayer({id:g,label:"Vuex Mutations",color:b}),n.addTimelineLayer({id:v,label:"Vuex Actions",color:b}),n.addInspector({id:y,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),n.on.getInspectorTree((function(n){if(n.app===e&&n.inspectorId===y)if(n.filter){var o=[];x(o,t._modules.root,n.filter,""),n.rootNodes=o}else n.rootNodes=[V(t._modules.root,"")]})),n.on.getInspectorState((function(n){if(n.app===e&&n.inspectorId===y){var o=n.nodeId;m(t,o),n.state=function(e,t,n){t="root"===n?t:t[n];var o=Object.keys(t),s={state:Object.keys(e.state).map((function(t){return{key:t,editable:!0,value:e.state[t]}}))};if(o.length){var a=function(e){var t={};return Object.keys(e).forEach((function(n){var o=n.split("/");if(o.length>1){var s=t,a=o.pop();o.forEach((function(e){s[e]||(s[e]={_custom:{value:{},display:e,tooltip:"Module",abstract:!0}}),s=s[e]._custom.value})),s[a]=S((function(){return e[n]}))}else t[n]=S((function(){return e[n]}))})),t}(t);s.getters=Object.keys(a).map((function(e){return{key:e.endsWith("/")?N(e):e,editable:!1,value:S((function(){return a[e]}))}}))}return s}((s=t._modules,(r=(a=o).split("/").filter((function(e){return e}))).reduce((function(e,t,n){var o=e[t];if(!o)throw new Error('Missing module "'+t+'" for path "'+a+'".');return n===r.length-1?o:o._children}),"root"===a?s:s.root._children)),"root"===o?t.getters:t._makeLocalGettersCache,o)}var s,a,r})),n.on.editInspectorState((function(n){if(n.app===e&&n.inspectorId===y){var o=n.nodeId,s=n.path;"root"!==o&&(s=o.split("/").filter(Boolean).concat(s)),t._withCommit((function(){n.set(t._state.data,s,n.state.value)}))}})),t.subscribe((function(e,t){var o={};e.payload&&(o.payload=e.payload),o.state=t,n.notifyComponentUpdate(),n.sendInspectorTree(y),n.sendInspectorState(y),n.addTimelineEvent({layerId:g,event:{time:Date.now(),title:e.type,data:o}})})),t.subscribeAction({before:function(e,t){var o={};e.payload&&(o.payload=e.payload),e._id=w++,e._time=Date.now(),o.state=t,n.addTimelineEvent({layerId:v,event:{time:e._time,title:e.type,groupId:e._id,subtitle:"start",data:o}})},after:function(e,t){var o={},s=Date.now()-e._time;o.duration={_custom:{type:"duration",display:s+"ms",tooltip:"Action duration",value:s}},e.payload&&(o.payload=e.payload),o.state=t,n.addTimelineEvent({layerId:v,event:{time:Date.now(),title:e.type,groupId:e._id,subtitle:"end",data:o}})}})}))}var b=8702998,_={label:"namespaced",textColor:16777215,backgroundColor:6710886};function N(e){return e&&"root"!==e?e.split("/").slice(-2,-1)[0]:"Root"}function V(e,t){return{id:t||"root",label:N(t),tags:e.namespaced?[_]:[],children:Object.keys(e._children).map((function(n){return V(e._children[n],t+n+"/")}))}}function x(e,t,n,o){o.includes(n)&&e.push({id:o||"root",label:o.endsWith("/")?o.slice(0,o.length-1):o||"Root",tags:t.namespaced?[_]:[]}),Object.keys(t._children).forEach((function(s){x(e,t._children[s],n,o+s+"/")}))}function S(e){try{return e()}catch(t){return t}}var R=function(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var n=e.state;this.state=("function"==typeof n?n():n)||{}},C={namespaced:{configurable:!0}};C.namespaced.get=function(){return!!this._rawModule.namespaced},R.prototype.addChild=function(e,t){this._children[e]=t},R.prototype.removeChild=function(e){delete this._children[e]},R.prototype.getChild=function(e){return this._children[e]},R.prototype.hasChild=function(e){return e in this._children},R.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)},R.prototype.forEachChild=function(e){c(this._children,e)},R.prototype.forEachGetter=function(e){this._rawModule.getters&&c(this._rawModule.getters,e)},R.prototype.forEachAction=function(e){this._rawModule.actions&&c(this._rawModule.actions,e)},R.prototype.forEachMutation=function(e){this._rawModule.mutations&&c(this._rawModule.mutations,e)},Object.defineProperties(R.prototype,C);var A=function(e){this.register([],e,!1)};function O(e,t,n){if(t.update(n),n.modules)for(var o in n.modules){if(!t.getChild(o))return;O(e.concat(o),t.getChild(o),n.modules[o])}}A.prototype.get=function(e){return e.reduce((function(e,t){return e.getChild(t)}),this.root)},A.prototype.getNamespace=function(e){var t=this.root;return e.reduce((function(e,n){return e+((t=t.getChild(n)).namespaced?n+"/":"")}),"")},A.prototype.update=function(e){O([],this.root,e)},A.prototype.register=function(e,t,n){var o=this;void 0===n&&(n=!0);var s=new R(t,n);0===e.length?this.root=s:this.get(e.slice(0,-1)).addChild(e[e.length-1],s);t.modules&&c(t.modules,(function(t,s){o.register(e.concat(s),t,n)}))},A.prototype.unregister=function(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1],o=t.getChild(n);o&&o.runtime&&t.removeChild(n)},A.prototype.isRegistered=function(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1];return!!t&&t.hasChild(n)};var T=function(e){var t=this;void 0===e&&(e={});var n=e.plugins;void 0===n&&(n=[]);var o=e.strict;void 0===o&&(o=!1);var s=e.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new A(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._scope=null,this._devtools=s;var a=this,r=this.dispatch,i=this.commit;this.dispatch=function(e,t){return r.call(a,e,t)},this.commit=function(e,t,n){return i.call(a,e,t,n)},this.strict=o;var c=this._modules.root.state;p(this,c,[],this._modules.root),d(this,c),n.forEach((function(e){return e(t)}))},k={state:{configurable:!0}};T.prototype.install=function(e,t){e.provide(t||r,this),e.config.globalProperties.$store=this,void 0!==this._devtools&&this._devtools&&E(e,this)},k.state.get=function(){return this._state.data},k.state.set=function(e){},T.prototype.commit=function(e,t,n){var o=this,s=h(e,t,n),a=s.type,r=s.payload,i={type:a,payload:r},c=this._mutations[a];c&&(this._withCommit((function(){c.forEach((function(e){e(r)}))})),this._subscribers.slice().forEach((function(e){return e(i,o.state)})))},T.prototype.dispatch=function(e,t){var n=this,o=h(e,t),s=o.type,a=o.payload,r={type:s,payload:a},i=this._actions[s];if(i){try{this._actionSubscribers.slice().filter((function(e){return e.before})).forEach((function(e){return e.before(r,n.state)}))}catch(l){}var c=i.length>1?Promise.all(i.map((function(e){return e(a)}))):i[0](a);return new Promise((function(e,t){c.then((function(t){try{n._actionSubscribers.filter((function(e){return e.after})).forEach((function(e){return e.after(r,n.state)}))}catch(l){}e(t)}),(function(e){try{n._actionSubscribers.filter((function(e){return e.error})).forEach((function(t){return t.error(r,n.state,e)}))}catch(l){}t(e)}))}))}},T.prototype.subscribe=function(e,t){return l(e,this._subscribers,t)},T.prototype.subscribeAction=function(e,t){return l("function"==typeof e?{before:e}:e,this._actionSubscribers,t)},T.prototype.watch=function(t,n,o){var s=this;return e.watch((function(){return t(s.state,s.getters)}),n,Object.assign({},o))},T.prototype.replaceState=function(e){var t=this;this._withCommit((function(){t._state.data=e}))},T.prototype.registerModule=function(e,t,n){void 0===n&&(n={}),"string"==typeof e&&(e=[e]),this._modules.register(e,t),p(this,this.state,e,this._modules.get(e),n.preserveState),d(this,this.state)},T.prototype.unregisterModule=function(e){var t=this;"string"==typeof e&&(e=[e]),this._modules.unregister(e),this._withCommit((function(){delete f(t.state,e.slice(0,-1))[e[e.length-1]]})),u(this)},T.prototype.hasModule=function(e){return"string"==typeof e&&(e=[e]),this._modules.isRegistered(e)},T.prototype.hotUpdate=function(e){this._modules.update(e),u(this,!0)},T.prototype._withCommit=function(e){var t=this._committing;this._committing=!0,e(),this._committing=t},Object.defineProperties(T.prototype,k);const B=e.ref("http://139.196.53.65:10089"),j=async(e,n="GET",o={})=>{const s=`${B.value}${e}`;try{const e={url:s,method:n,timeout:1e5};"GET"===n?e.data=o:(e.data=o,e.header={"Content-Type":"application/x-www-form-urlencoded"});const t=await uni.request(e);if(200===t.statusCode)return t.data;throw new Error(`请求失败，状态码: ${t.statusCode}`)}catch(a){throw t("error","at api/index.js:49","请求出错:",a),a}},L=e=>j("/api/control/relay_status","GET",{device:e}),D=(e,t)=>j("/api/control/set_relay_status","GET",{device:e,status:t}),U=()=>j("/api/control/rules","GET"),M=e=>j("/api/control/set_rules","GET",{rules:e}),P=e=>j("/api/control/add_rules","POST",e),F=()=>j("/api/control/all_plants","GET"),q=e=>j("/api/control/set_mod","GET",{mod:e}),I=()=>j("/api/control/mod","GET"),z=e=>j("/api/control/send_msg","GET",{msg:e}),$=(e,t)=>{const n=e.__vccOpts||e;for(const[o,s]of t)n[o]=s;return n},G=$({__name:"DeviceControl",setup(n){const o=i(),s=e.computed((()=>o.getters.deviceList)),a=e.computed((()=>o.getters.isAutoMode)),r=e.computed((()=>o.state.requestStatus)),c=e.ref(!1),l=e.ref("--:--:--"),u=e.ref(5);let d=null;const p=e=>{switch(e){case"on":return"运行中";case"off":return"已停止";case"null":return"已断连";default:return"未知状态"}},m=async()=>{const e=a.value?"manual":"auto";try{await o.dispatch("setMode",e),await f()}catch(n){t("error","at components/DeviceControl.vue:129","切换模式失败:",n)}},f=async()=>{try{await o.dispatch("fetchAllDevicesStatus",!0),g()}catch(e){t("error","at components/DeviceControl.vue:140","静默获取设备状态失败:",e)}},h=async()=>{c.value=!0;try{await o.dispatch("fetchAllDevicesStatus"),g()}catch(e){t("error","at components/DeviceControl.vue:152","获取设备状态失败:",e)}finally{c.value=!1}},g=()=>{const e=new Date;l.value=`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}`};return e.onMounted((()=>{f(),d=setInterval((()=>{f()}),1e3*u.value)})),e.onUnmounted((()=>{d&&clearInterval(d)})),(n,i)=>(e.openBlock(),e.createElementBlock("view",{class:"device-control"},[e.createElementVNode("view",{class:"panel-header"},[e.createElementVNode("text",{class:"panel-title"},"设备控制"),e.createElementVNode("view",{class:"panel-status"},[e.createElementVNode("text",{class:"status-label"},"当前模式:"),e.createElementVNode("text",{class:e.normalizeClass(["status-value",{"auto-mode":e.unref(a)}])},e.toDisplayString(e.unref(a)?"自动模式":"手动模式"),3),e.createElementVNode("view",{class:"mode-switch",onClick:m},[e.createElementVNode("view",{class:e.normalizeClass(["switch-track",{"is-auto":e.unref(a)}])},[e.createElementVNode("view",{class:"switch-thumb"})],2),e.createElementVNode("text",{class:"switch-text"},e.toDisplayString(e.unref(a)?"自动":"手动"),1)])])]),e.createElementVNode("view",{class:"device-status-refresh"},[e.createElementVNode("text",{class:"refresh-text"},"设备状态每 "+e.toDisplayString(u.value)+"s 自动刷新",1),e.createElementVNode("view",{class:"refresh-btn",onClick:h},[e.createElementVNode("view",{class:e.normalizeClass(["refresh-icon",{refreshing:c.value}])},null,2),e.createElementVNode("text",null,"刷新")]),e.createElementVNode("text",{class:"last-updated"},"上次更新: "+e.toDisplayString(l.value),1)]),e.createElementVNode("view",{class:"devices-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),(n=>(e.openBlock(),e.createElementBlock("view",{key:n.id,class:e.normalizeClass(["device-item",{"is-on":"on"===n.status,"is-offline":"null"===n.status}])},[e.createElementVNode("view",{class:"device-icon"},[e.createElementVNode("view",{class:e.normalizeClass(["icon-inner",n.id])},["on"===n.status?(e.openBlock(),e.createElementBlock("view",{key:0,class:"icon-animation"})):e.createCommentVNode("",!0)],2)]),e.createElementVNode("view",{class:"device-info"},[e.createElementVNode("text",{class:"device-name"},e.toDisplayString(n.name),1),e.createElementVNode("text",{class:e.normalizeClass(["device-status",{"status-on":"on"===n.status,"status-off":"off"===n.status,"status-offline":"null"===n.status}])},e.toDisplayString(p(n.status)),3)]),e.createElementVNode("view",{class:"device-toggle"},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-track",{"is-on":"on"===n.status}]),onClick:e=>(async e=>{if(a.value||"null"===e.status)return;const n="on"===e.status?"off":"on";try{await o.dispatch("setDeviceStatus",{device:e.id,status:n}),await f()}catch(s){t("error","at components/DeviceControl.vue:117","控制设备失败:",s)}})(n),disabled:e.unref(a)||"null"===n.status},[e.createElementVNode("view",{class:"toggle-thumb"})],10,["onClick","disabled"])]),e.unref(a)||"null"===n.status?(e.openBlock(),e.createElementBlock("view",{key:0,class:"device-mask"},[e.createElementVNode("text",{class:"mask-text"},e.toDisplayString(e.unref(a)?"自动控制中":"设备已断连"),1)])):e.createCommentVNode("",!0)],2)))),128))]),e.unref(r).message?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["status-message",{success:e.unref(r).success}])},e.toDisplayString(e.unref(r).message),3)):e.createCommentVNode("",!0)]))}},[["__scopeId","data-v-860729db"]]),H=$({__name:"ModeSwitch",setup(n){const o=i(),s=e.computed((()=>o.state.currentMode)),a=async e=>{if(s.value!==e)try{await o.dispatch("setMode",e)}catch(n){t("error","at components/ModeSwitch.vue:64","切换模式失败:",n)}};return(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"mode-switch-panel"},[e.createElementVNode("view",{class:"panel-header"},[e.createElementVNode("text",{class:"panel-title"},"运行模式")]),e.createElementVNode("view",{class:"mode-content"},[e.createElementVNode("view",{class:"mode-options"},[e.createElementVNode("view",{class:e.normalizeClass(["mode-option",{active:"auto"===e.unref(s)}]),onClick:n[0]||(n[0]=e=>a("auto"))},[e.createElementVNode("view",{class:"option-icon auto-icon"},["auto"===e.unref(s)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"icon-animation"})):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"option-text-container"},[e.createElementVNode("text",{class:"option-text"},"自动模式"),e.createElementVNode("text",{class:"option-desc"},"根据规则自动控制")])],2),e.createElementVNode("view",{class:e.normalizeClass(["mode-option",{active:"manual"===e.unref(s)}]),onClick:n[1]||(n[1]=e=>a("manual"))},[e.createElementVNode("view",{class:"option-icon manual-icon"},["manual"===e.unref(s)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"icon-animation"})):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"option-text-container"},[e.createElementVNode("text",{class:"option-text"},"手动模式"),e.createElementVNode("text",{class:"option-desc"},"手动控制每个设备")])],2)]),e.createElementVNode("view",{class:"current-mode"},[e.createElementVNode("text",{class:"mode-label"},"当前模式:"),e.createElementVNode("view",{class:e.normalizeClass(["mode-indicator",{auto:"auto"===e.unref(s)}])},[e.createElementVNode("text",{class:"indicator-text"},e.toDisplayString("auto"===e.unref(s)?"自动控制":"手动控制"),1)],2)])])]))}},[["__scopeId","data-v-3f8a4a9f"]]),W=$({__name:"PlantRules",setup(n){const o=i(),s=e.computed((()=>o.state.currentRule)),a=e.computed((()=>o.state.allRules)),r=e.computed((()=>o.getters.isAutoMode)),c=e.ref(!1),l=e.reactive({plants:"",min_soil_humidity:"",max_soil_humidity:"",min_nitrogen:"",max_nitrogen:"",min_phosphorus:"",max_phosphorus:"",min_potassium:"",max_potassium:"",start_time:"",end_time:""}),u=async()=>{const e=["plants","min_soil_humidity","max_soil_humidity","min_nitrogen","max_nitrogen","min_phosphorus","max_phosphorus","min_potassium","max_potassium","start_time","end_time"];for(const t of e)if(!l[t])return void uni.showToast({title:"请填写所有必填项",icon:"none"});const n={...l,min_soil_humidity:Number(l.min_soil_humidity),max_soil_humidity:Number(l.max_soil_humidity),min_nitrogen:Number(l.min_nitrogen),max_nitrogen:Number(l.max_nitrogen),min_phosphorus:Number(l.min_phosphorus),max_phosphorus:Number(l.max_phosphorus),min_potassium:Number(l.min_potassium),max_potassium:Number(l.max_potassium)};try{0===(await o.dispatch("addRule",n)).code&&(Object.keys(l).forEach((e=>{l[e]=""})),c.value=!1,uni.showToast({title:"规则添加成功",icon:"success"}))}catch(s){t("error","at components/PlantRules.vue:263","添加规则失败:",s)}};return e.watch(r,(e=>{e||uni.showToast({title:"手动模式下无法选择植物规则",icon:"none",duration:2e3})})),(n,i)=>(e.openBlock(),e.createElementBlock("view",{class:"plant-rules"},[e.createElementVNode("view",{class:"panel-header"},[e.createElementVNode("text",{class:"panel-title"},"种植物规则"),e.createElementVNode("button",{class:"add-rule-btn",onClick:i[0]||(i[0]=e=>c.value=!0)},[e.createElementVNode("view",{class:"btn-icon-plus"}),e.createElementVNode("text",null,"添加")])]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"rules-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(n=>(e.openBlock(),e.createElementBlock("view",{key:n.id,class:e.normalizeClass(["rule-item",{active:n.plants===e.unref(s)}]),onClick:e=>(async e=>{if(e!==s.value)if(r.value)try{await o.dispatch("setRule",e)}catch(n){t("error","at components/PlantRules.vue:211","设置规则失败:",n)}else uni.showToast({title:"请先切换到自动模式",icon:"none"})})(n.plants)},[e.createElementVNode("view",{class:"rule-header"},[e.createElementVNode("view",{class:"rule-name-area"},[e.createElementVNode("text",{class:"rule-name"},e.toDisplayString(n.plants),1),n.plants===e.unref(s)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"rule-badge"},"当前")):e.createCommentVNode("",!0)]),n.plants!==e.unref(s)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"rule-select"},"选择")):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"rule-grid"},[e.createElementVNode("view",{class:"rule-param"},[e.createElementVNode("view",{class:"param-icon humidity"}),e.createElementVNode("view",{class:"param-info"},[e.createElementVNode("text",{class:"param-label"},"湿度范围"),e.createElementVNode("text",{class:"param-value"},e.toDisplayString(n.min_soil_humidity)+"% - "+e.toDisplayString(n.max_soil_humidity)+"%",1)])]),e.createElementVNode("view",{class:"rule-param"},[e.createElementVNode("view",{class:"param-icon time"}),e.createElementVNode("view",{class:"param-info"},[e.createElementVNode("text",{class:"param-label"},"运行时间"),e.createElementVNode("text",{class:"param-value"},e.toDisplayString(n.start_time)+" - "+e.toDisplayString(n.end_time),1)])]),e.createElementVNode("view",{class:"rule-param"},[e.createElementVNode("view",{class:"param-icon nitrogen"}),e.createElementVNode("view",{class:"param-info"},[e.createElementVNode("text",{class:"param-label"},"氮含量"),e.createElementVNode("text",{class:"param-value"},e.toDisplayString(n.min_nitrogen)+" - "+e.toDisplayString(n.max_nitrogen),1)])]),e.createElementVNode("view",{class:"rule-param"},[e.createElementVNode("view",{class:"param-icon phosphorus"}),e.createElementVNode("view",{class:"param-info"},[e.createElementVNode("text",{class:"param-label"},"磷含量"),e.createElementVNode("text",{class:"param-value"},e.toDisplayString(n.min_phosphorus)+" - "+e.toDisplayString(n.max_phosphorus),1)])]),e.createElementVNode("view",{class:"rule-param"},[e.createElementVNode("view",{class:"param-icon potassium"}),e.createElementVNode("view",{class:"param-info"},[e.createElementVNode("text",{class:"param-label"},"钾含量"),e.createElementVNode("text",{class:"param-value"},e.toDisplayString(n.min_potassium)+" - "+e.toDisplayString(n.max_potassium),1)])])])],10,["onClick"])))),128)),0===e.unref(a).length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"no-rules"},[e.createElementVNode("view",{class:"empty-icon"}),e.createElementVNode("text",{class:"empty-text"},"暂无植物规则"),e.createElementVNode("text",{class:"empty-subtext"},"点击右上角添加规则按钮创建新规则")])):e.createCommentVNode("",!0)]),c.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal-overlay",onClick:i[15]||(i[15]=e=>c.value=!1)},[e.createElementVNode("view",{class:"modal-content",onClick:i[14]||(i[14]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},"添加新规则"),e.createElementVNode("view",{class:"modal-close",onClick:i[1]||(i[1]=e=>c.value=!1)},"✕")]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"modal-body"},[e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("text",{class:"form-label required"},"种植物名称"),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[2]||(i[2]=e=>l.plants=e),placeholder:"请输入种植物名称"},null,512),[[e.vModelText,l.plants]])]),e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("text",{class:"section-title"},"湿度设置"),e.createElementVNode("view",{class:"form-row"},[e.createElementVNode("view",{class:"form-group half"},[e.createElementVNode("text",{class:"form-label required"},"最低湿度(%)"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"digit","onUpdate:modelValue":i[3]||(i[3]=e=>l.min_soil_humidity=e),placeholder:"60"},null,512),[[e.vModelText,l.min_soil_humidity]])]),e.createElementVNode("view",{class:"form-group half"},[e.createElementVNode("text",{class:"form-label required"},"最高湿度(%)"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"digit","onUpdate:modelValue":i[4]||(i[4]=e=>l.max_soil_humidity=e),placeholder:"80"},null,512),[[e.vModelText,l.max_soil_humidity]])])])]),e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("text",{class:"section-title"},"养分含量设置"),e.createElementVNode("view",{class:"form-row"},[e.createElementVNode("view",{class:"form-group half"},[e.createElementVNode("text",{class:"form-label required"},"最低氮含量"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"digit","onUpdate:modelValue":i[5]||(i[5]=e=>l.min_nitrogen=e),placeholder:"1000"},null,512),[[e.vModelText,l.min_nitrogen]])]),e.createElementVNode("view",{class:"form-group half"},[e.createElementVNode("text",{class:"form-label required"},"最高氮含量"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"digit","onUpdate:modelValue":i[6]||(i[6]=e=>l.max_nitrogen=e),placeholder:"2000"},null,512),[[e.vModelText,l.max_nitrogen]])])]),e.createElementVNode("view",{class:"form-row"},[e.createElementVNode("view",{class:"form-group half"},[e.createElementVNode("text",{class:"form-label required"},"最低磷含量"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"digit","onUpdate:modelValue":i[7]||(i[7]=e=>l.min_phosphorus=e),placeholder:"500"},null,512),[[e.vModelText,l.min_phosphorus]])]),e.createElementVNode("view",{class:"form-group half"},[e.createElementVNode("text",{class:"form-label required"},"最高磷含量"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"digit","onUpdate:modelValue":i[8]||(i[8]=e=>l.max_phosphorus=e),placeholder:"1000"},null,512),[[e.vModelText,l.max_phosphorus]])])]),e.createElementVNode("view",{class:"form-row"},[e.createElementVNode("view",{class:"form-group half"},[e.createElementVNode("text",{class:"form-label required"},"最低钾含量"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"digit","onUpdate:modelValue":i[9]||(i[9]=e=>l.min_potassium=e),placeholder:"800"},null,512),[[e.vModelText,l.min_potassium]])]),e.createElementVNode("view",{class:"form-group half"},[e.createElementVNode("text",{class:"form-label required"},"最高钾含量"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"digit","onUpdate:modelValue":i[10]||(i[10]=e=>l.max_potassium=e),placeholder:"1500"},null,512),[[e.vModelText,l.max_potassium]])])])]),e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("text",{class:"section-title"},"运行时间设置"),e.createElementVNode("view",{class:"form-row"},[e.createElementVNode("view",{class:"form-group half"},[e.createElementVNode("text",{class:"form-label required"},"开始时间"),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[11]||(i[11]=e=>l.start_time=e),placeholder:"8:30"},null,512),[[e.vModelText,l.start_time]])]),e.createElementVNode("view",{class:"form-group half"},[e.createElementVNode("text",{class:"form-label required"},"结束时间"),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[12]||(i[12]=e=>l.end_time=e),placeholder:"17:30"},null,512),[[e.vModelText,l.end_time]])])])])]),e.createElementVNode("view",{class:"modal-footer"},[e.createElementVNode("button",{class:"form-btn cancel",onClick:i[13]||(i[13]=e=>c.value=!1)},"取消"),e.createElementVNode("button",{class:"form-btn submit",onClick:u},"添加规则")])])])):e.createCommentVNode("",!0)]))}},[["__scopeId","data-v-33d2f7d2"]]);function J(e,t){return function(){return e.apply(t,arguments)}}const{toString:K}=Object.prototype,{getPrototypeOf:Q}=Object,X=(Y=Object.create(null),e=>{const t=K.call(e);return Y[t]||(Y[t]=t.slice(8,-1).toLowerCase())});var Y;const Z=e=>(e=e.toLowerCase(),t=>X(t)===e),ee=e=>t=>typeof t===e,{isArray:te}=Array,ne=ee("undefined");const oe=Z("ArrayBuffer");const se=ee("string"),ae=ee("function"),re=ee("number"),ie=e=>null!==e&&"object"==typeof e,ce=e=>{if("object"!==X(e))return!1;const t=Q(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},le=Z("Date"),ue=Z("File"),de=Z("Blob"),pe=Z("FileList"),me=Z("URLSearchParams"),[fe,he,ge,ve]=["ReadableStream","Request","Response","Headers"].map(Z);function ye(e,t,{allOwnKeys:n=!1}={}){if(null==e)return;let o,s;if("object"!=typeof e&&(e=[e]),te(e))for(o=0,s=e.length;o<s;o++)t.call(null,e[o],o,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),a=s.length;let r;for(o=0;o<a;o++)r=s[o],t.call(null,e[r],r,e)}}function we(e,t){t=t.toLowerCase();const n=Object.keys(e);let o,s=n.length;for(;s-- >0;)if(o=n[s],t===o.toLowerCase())return o;return null}const Ee="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,be=e=>!ne(e)&&e!==Ee;const _e=(Ne="undefined"!=typeof Uint8Array&&Q(Uint8Array),e=>Ne&&e instanceof Ne);var Ne;const Ve=Z("HTMLFormElement"),xe=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Se=Z("RegExp"),Re=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),o={};ye(n,((n,s)=>{let a;!1!==(a=t(n,s,e))&&(o[s]=a||n)})),Object.defineProperties(e,o)};const Ce=Z("AsyncFunction"),Ae=(Oe="function"==typeof setImmediate,Te=ae(Ee.postMessage),Oe?setImmediate:Te?(ke=`axios@${Math.random()}`,Be=[],Ee.addEventListener("message",(({source:e,data:t})=>{e===Ee&&t===ke&&Be.length&&Be.shift()()}),!1),e=>{Be.push(e),Ee.postMessage(ke,"*")}):e=>setTimeout(e));var Oe,Te,ke,Be;const je="undefined"!=typeof queueMicrotask?queueMicrotask.bind(Ee):"undefined"!=typeof process&&process.nextTick||Ae,Le={isArray:te,isArrayBuffer:oe,isBuffer:function(e){return null!==e&&!ne(e)&&null!==e.constructor&&!ne(e.constructor)&&ae(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||ae(e.append)&&("formdata"===(t=X(e))||"object"===t&&ae(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&oe(e.buffer),t},isString:se,isNumber:re,isBoolean:e=>!0===e||!1===e,isObject:ie,isPlainObject:ce,isReadableStream:fe,isRequest:he,isResponse:ge,isHeaders:ve,isUndefined:ne,isDate:le,isFile:ue,isBlob:de,isRegExp:Se,isFunction:ae,isStream:e=>ie(e)&&ae(e.pipe),isURLSearchParams:me,isTypedArray:_e,isFileList:pe,forEach:ye,merge:function e(){const{caseless:t}=be(this)&&this||{},n={},o=(o,s)=>{const a=t&&we(n,s)||s;ce(n[a])&&ce(o)?n[a]=e(n[a],o):ce(o)?n[a]=e({},o):te(o)?n[a]=o.slice():n[a]=o};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&ye(arguments[s],o);return n},extend:(e,t,n,{allOwnKeys:o}={})=>(ye(t,((t,o)=>{n&&ae(t)?e[o]=J(t,n):e[o]=t}),{allOwnKeys:o}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,o)=>{e.prototype=Object.create(t.prototype,o),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,o)=>{let s,a,r;const i={};if(t=t||{},null==e)return t;do{for(s=Object.getOwnPropertyNames(e),a=s.length;a-- >0;)r=s[a],o&&!o(r,e,t)||i[r]||(t[r]=e[r],i[r]=!0);e=!1!==n&&Q(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:X,kindOfTest:Z,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const o=e.indexOf(t,n);return-1!==o&&o===n},toArray:e=>{if(!e)return null;if(te(e))return e;let t=e.length;if(!re(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let o;for(;(o=n.next())&&!o.done;){const n=o.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const o=[];for(;null!==(n=e.exec(t));)o.push(n);return o},isHTMLForm:Ve,hasOwnProperty:xe,hasOwnProp:xe,reduceDescriptors:Re,freezeMethods:e=>{Re(e,((t,n)=>{if(ae(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const o=e[n];ae(o)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},o=e=>{e.forEach((e=>{n[e]=!0}))};return te(e)?o(e):o(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:we,global:Ee,isContextDefined:be,isSpecCompliantForm:function(e){return!!(e&&ae(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(e,o)=>{if(ie(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[o]=e;const s=te(e)?[]:{};return ye(e,((e,t)=>{const a=n(e,o+1);!ne(a)&&(s[t]=a)})),t[o]=void 0,s}}return e};return n(e,0)},isAsyncFn:Ce,isThenable:e=>e&&(ie(e)||ae(e))&&ae(e.then)&&ae(e.catch),setImmediate:Ae,asap:je};function De(e,t,n,o,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),o&&(this.request=o),s&&(this.response=s,this.status=s.status?s.status:null)}Le.inherits(De,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Le.toJSONObject(this.config),code:this.code,status:this.status}}});const Ue=De.prototype,Me={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{Me[e]={value:e}})),Object.defineProperties(De,Me),Object.defineProperty(Ue,"isAxiosError",{value:!0}),De.from=(e,t,n,o,s,a)=>{const r=Object.create(Ue);return Le.toFlatObject(e,r,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),De.call(r,e.message,t,n,o,s),r.cause=e,r.name=e.name,a&&Object.assign(r,a),r};function Pe(e){return Le.isPlainObject(e)||Le.isArray(e)}function Fe(e){return Le.endsWith(e,"[]")?e.slice(0,-2):e}function qe(e,t,n){return e?e.concat(t).map((function(e,t){return e=Fe(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const Ie=Le.toFlatObject(Le,{},null,(function(e){return/^is[A-Z]/.test(e)}));function ze(e,t,n){if(!Le.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const o=(n=Le.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!Le.isUndefined(t[e])}))).metaTokens,s=n.visitor||l,a=n.dots,r=n.indexes,i=(n.Blob||"undefined"!=typeof Blob&&Blob)&&Le.isSpecCompliantForm(t);if(!Le.isFunction(s))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(Le.isDate(e))return e.toISOString();if(!i&&Le.isBlob(e))throw new De("Blob is not supported. Use a Buffer instead.");return Le.isArrayBuffer(e)||Le.isTypedArray(e)?i&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function l(e,n,s){let i=e;if(e&&!s&&"object"==typeof e)if(Le.endsWith(n,"{}"))n=o?n:n.slice(0,-2),e=JSON.stringify(e);else if(Le.isArray(e)&&function(e){return Le.isArray(e)&&!e.some(Pe)}(e)||(Le.isFileList(e)||Le.endsWith(n,"[]"))&&(i=Le.toArray(e)))return n=Fe(n),i.forEach((function(e,o){!Le.isUndefined(e)&&null!==e&&t.append(!0===r?qe([n],o,a):null===r?n:n+"[]",c(e))})),!1;return!!Pe(e)||(t.append(qe(s,n,a),c(e)),!1)}const u=[],d=Object.assign(Ie,{defaultVisitor:l,convertValue:c,isVisitable:Pe});if(!Le.isObject(e))throw new TypeError("data must be an object");return function e(n,o){if(!Le.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+o.join("."));u.push(n),Le.forEach(n,(function(n,a){!0===(!(Le.isUndefined(n)||null===n)&&s.call(t,n,Le.isString(a)?a.trim():a,o,d))&&e(n,o?o.concat(a):[a])})),u.pop()}}(e),t}function $e(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function Ge(e,t){this._pairs=[],e&&ze(e,this,t)}const He=Ge.prototype;function We(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Je(e,t,n){if(!t)return e;const o=n&&n.encode||We;Le.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let a;if(a=s?s(t,n):Le.isURLSearchParams(t)?t.toString():new Ge(t,n).toString(o),a){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+a}return e}He.append=function(e,t){this._pairs.push([e,t])},He.toString=function(e){const t=e?function(t){return e.call(this,t,$e)}:$e;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const Ke=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Le.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},Qe={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Xe={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:Ge,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},Ye="undefined"!=typeof window&&"undefined"!=typeof document,Ze="object"==typeof navigator&&navigator||void 0,et=Ye&&(!Ze||["ReactNative","NativeScript","NS"].indexOf(Ze.product)<0),tt="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,nt=Ye&&window.location.href||"http://localhost",ot={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ye,hasStandardBrowserEnv:et,hasStandardBrowserWebWorkerEnv:tt,navigator:Ze,origin:nt},Symbol.toStringTag,{value:"Module"})),...Xe};function st(e){function t(e,n,o,s){let a=e[s++];if("__proto__"===a)return!0;const r=Number.isFinite(+a),i=s>=e.length;if(a=!a&&Le.isArray(o)?o.length:a,i)return Le.hasOwnProp(o,a)?o[a]=[o[a],n]:o[a]=n,!r;o[a]&&Le.isObject(o[a])||(o[a]=[]);return t(e,n,o[a],s)&&Le.isArray(o[a])&&(o[a]=function(e){const t={},n=Object.keys(e);let o;const s=n.length;let a;for(o=0;o<s;o++)a=n[o],t[a]=e[a];return t}(o[a])),!r}if(Le.isFormData(e)&&Le.isFunction(e.entries)){const n={};return Le.forEachEntry(e,((e,o)=>{t(function(e){return Le.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),o,n,0)})),n}return null}const at={transitional:Qe,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",o=n.indexOf("application/json")>-1,s=Le.isObject(e);s&&Le.isHTMLForm(e)&&(e=new FormData(e));if(Le.isFormData(e))return o?JSON.stringify(st(e)):e;if(Le.isArrayBuffer(e)||Le.isBuffer(e)||Le.isStream(e)||Le.isFile(e)||Le.isBlob(e)||Le.isReadableStream(e))return e;if(Le.isArrayBufferView(e))return e.buffer;if(Le.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return ze(e,new ot.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,o){return ot.isNode&&Le.isBuffer(e)?(this.append(t,e.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((a=Le.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return ze(a?{"files[]":e}:e,t&&new t,this.formSerializer)}}return s||o?(t.setContentType("application/json",!1),function(e,t,n){if(Le.isString(e))try{return(t||JSON.parse)(e),Le.trim(e)}catch(o){if("SyntaxError"!==o.name)throw o}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||at.transitional,n=t&&t.forcedJSONParsing,o="json"===this.responseType;if(Le.isResponse(e)||Le.isReadableStream(e))return e;if(e&&Le.isString(e)&&(n&&!this.responseType||o)){const n=!(t&&t.silentJSONParsing)&&o;try{return JSON.parse(e)}catch(s){if(n){if("SyntaxError"===s.name)throw De.from(s,De.ERR_BAD_RESPONSE,this,null,this.response);throw s}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ot.classes.FormData,Blob:ot.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Le.forEach(["delete","get","head","post","put","patch"],(e=>{at.headers[e]={}}));const rt=at,it=Le.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ct=Symbol("internals");function lt(e){return e&&String(e).trim().toLowerCase()}function ut(e){return!1===e||null==e?e:Le.isArray(e)?e.map(ut):String(e)}function dt(e,t,n,o,s){return Le.isFunction(o)?o.call(this,t,n):(s&&(t=n),Le.isString(t)?Le.isString(o)?-1!==t.indexOf(o):Le.isRegExp(o)?o.test(t):void 0:void 0)}class pt{constructor(e){e&&this.set(e)}set(e,t,n){const o=this;function s(e,t,n){const s=lt(t);if(!s)throw new Error("header name must be a non-empty string");const a=Le.findKey(o,s);(!a||void 0===o[a]||!0===n||void 0===n&&!1!==o[a])&&(o[a||t]=ut(e))}const a=(e,t)=>Le.forEach(e,((e,n)=>s(e,n,t)));if(Le.isPlainObject(e)||e instanceof this.constructor)a(e,t);else if(Le.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))a((e=>{const t={};let n,o,s;return e&&e.split("\n").forEach((function(e){s=e.indexOf(":"),n=e.substring(0,s).trim().toLowerCase(),o=e.substring(s+1).trim(),!n||t[n]&&it[n]||("set-cookie"===n?t[n]?t[n].push(o):t[n]=[o]:t[n]=t[n]?t[n]+", "+o:o)})),t})(e),t);else if(Le.isHeaders(e))for(const[r,i]of e.entries())s(i,r,n);else null!=e&&s(t,e,n);return this}get(e,t){if(e=lt(e)){const n=Le.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=n.exec(e);)t[o[1]]=o[2];return t}(e);if(Le.isFunction(t))return t.call(this,e,n);if(Le.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=lt(e)){const n=Le.findKey(this,e);return!(!n||void 0===this[n]||t&&!dt(0,this[n],n,t))}return!1}delete(e,t){const n=this;let o=!1;function s(e){if(e=lt(e)){const s=Le.findKey(n,e);!s||t&&!dt(0,n[s],s,t)||(delete n[s],o=!0)}}return Le.isArray(e)?e.forEach(s):s(e),o}clear(e){const t=Object.keys(this);let n=t.length,o=!1;for(;n--;){const s=t[n];e&&!dt(0,this[s],s,e,!0)||(delete this[s],o=!0)}return o}normalize(e){const t=this,n={};return Le.forEach(this,((o,s)=>{const a=Le.findKey(n,s);if(a)return t[a]=ut(o),void delete t[s];const r=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(s):String(s).trim();r!==s&&delete t[s],t[r]=ut(o),n[r]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Le.forEach(this,((n,o)=>{null!=n&&!1!==n&&(t[o]=e&&Le.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach((e=>n.set(e))),n}static accessor(e){const t=(this[ct]=this[ct]={accessors:{}}).accessors,n=this.prototype;function o(e){const o=lt(e);t[o]||(!function(e,t){const n=Le.toCamelCase(" "+t);["get","set","has"].forEach((o=>{Object.defineProperty(e,o+n,{value:function(e,n,s){return this[o].call(this,t,e,n,s)},configurable:!0})}))}(n,e),t[o]=!0)}return Le.isArray(e)?e.forEach(o):o(e),this}}pt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Le.reduceDescriptors(pt.prototype,(({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[n]=e}}})),Le.freezeMethods(pt);const mt=pt;function ft(e,t){const n=this||rt,o=t||n,s=mt.from(o.headers);let a=o.data;return Le.forEach(e,(function(e){a=e.call(n,a,s.normalize(),t?t.status:void 0)})),s.normalize(),a}function ht(e){return!(!e||!e.__CANCEL__)}function gt(e,t,n){De.call(this,null==e?"canceled":e,De.ERR_CANCELED,t,n),this.name="CanceledError"}function vt(e,t,n){const o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(new De("Request failed with status code "+n.status,[De.ERR_BAD_REQUEST,De.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}Le.inherits(gt,De,{__CANCEL__:!0});const yt=(e,t,n=3)=>{let o=0;const s=function(e,t){e=e||10;const n=new Array(e),o=new Array(e);let s,a=0,r=0;return t=void 0!==t?t:1e3,function(i){const c=Date.now(),l=o[r];s||(s=c),n[a]=i,o[a]=c;let u=r,d=0;for(;u!==a;)d+=n[u++],u%=e;if(a=(a+1)%e,a===r&&(r=(r+1)%e),c-s<t)return;const p=l&&c-l;return p?Math.round(1e3*d/p):void 0}}(50,250);return function(e,t){let n,o,s=0,a=1e3/t;const r=(t,a=Date.now())=>{s=a,n=null,o&&(clearTimeout(o),o=null),e.apply(null,t)};return[(...e)=>{const t=Date.now(),i=t-s;i>=a?r(e,t):(n=e,o||(o=setTimeout((()=>{o=null,r(n)}),a-i)))},()=>n&&r(n)]}((n=>{const a=n.loaded,r=n.lengthComputable?n.total:void 0,i=a-o,c=s(i);o=a;e({loaded:a,total:r,progress:r?a/r:void 0,bytes:i,rate:c||void 0,estimated:c&&r&&a<=r?(r-a)/c:void 0,event:n,lengthComputable:null!=r,[t?"download":"upload"]:!0})}),n)},wt=(e,t)=>{const n=null!=e;return[o=>t[0]({lengthComputable:n,total:e,loaded:o}),t[1]]},Et=e=>(...t)=>Le.asap((()=>e(...t))),bt=ot.hasStandardBrowserEnv?(_t=new URL(ot.origin),Nt=ot.navigator&&/(msie|trident)/i.test(ot.navigator.userAgent),e=>(e=new URL(e,ot.origin),_t.protocol===e.protocol&&_t.host===e.host&&(Nt||_t.port===e.port))):()=>!0;var _t,Nt;const Vt=ot.hasStandardBrowserEnv?{write(e,t,n,o,s,a){const r=[e+"="+encodeURIComponent(t)];Le.isNumber(n)&&r.push("expires="+new Date(n).toGMTString()),Le.isString(o)&&r.push("path="+o),Le.isString(s)&&r.push("domain="+s),!0===a&&r.push("secure"),document.cookie=r.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function xt(e,t,n){let o=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(o||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const St=e=>e instanceof mt?{...e}:e;function Rt(e,t){t=t||{};const n={};function o(e,t,n,o){return Le.isPlainObject(e)&&Le.isPlainObject(t)?Le.merge.call({caseless:o},e,t):Le.isPlainObject(t)?Le.merge({},t):Le.isArray(t)?t.slice():t}function s(e,t,n,s){return Le.isUndefined(t)?Le.isUndefined(e)?void 0:o(void 0,e,0,s):o(e,t,0,s)}function a(e,t){if(!Le.isUndefined(t))return o(void 0,t)}function r(e,t){return Le.isUndefined(t)?Le.isUndefined(e)?void 0:o(void 0,e):o(void 0,t)}function i(n,s,a){return a in t?o(n,s):a in e?o(void 0,n):void 0}const c={url:a,method:a,data:a,baseURL:r,transformRequest:r,transformResponse:r,paramsSerializer:r,timeout:r,timeoutMessage:r,withCredentials:r,withXSRFToken:r,adapter:r,responseType:r,xsrfCookieName:r,xsrfHeaderName:r,onUploadProgress:r,onDownloadProgress:r,decompress:r,maxContentLength:r,maxBodyLength:r,beforeRedirect:r,transport:r,httpAgent:r,httpsAgent:r,cancelToken:r,socketPath:r,responseEncoding:r,validateStatus:i,headers:(e,t,n)=>s(St(e),St(t),0,!0)};return Le.forEach(Object.keys(Object.assign({},e,t)),(function(o){const a=c[o]||s,r=a(e[o],t[o],o);Le.isUndefined(r)&&a!==i||(n[o]=r)})),n}const Ct=e=>{const t=Rt({},e);let n,{data:o,withXSRFToken:s,xsrfHeaderName:a,xsrfCookieName:r,headers:i,auth:c}=t;if(t.headers=i=mt.from(i),t.url=Je(xt(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),c&&i.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),Le.isFormData(o))if(ot.hasStandardBrowserEnv||ot.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(!1!==(n=i.getContentType())){const[e,...t]=n?n.split(";").map((e=>e.trim())).filter(Boolean):[];i.setContentType([e||"multipart/form-data",...t].join("; "))}if(ot.hasStandardBrowserEnv&&(s&&Le.isFunction(s)&&(s=s(t)),s||!1!==s&&bt(t.url))){const e=a&&r&&Vt.read(r);e&&i.set(a,e)}return t},At="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){const o=Ct(e);let s=o.data;const a=mt.from(o.headers).normalize();let r,i,c,l,u,{responseType:d,onUploadProgress:p,onDownloadProgress:m}=o;function f(){l&&l(),u&&u(),o.cancelToken&&o.cancelToken.unsubscribe(r),o.signal&&o.signal.removeEventListener("abort",r)}let h=new XMLHttpRequest;function g(){if(!h)return;const o=mt.from("getAllResponseHeaders"in h&&h.getAllResponseHeaders());vt((function(e){t(e),f()}),(function(e){n(e),f()}),{data:d&&"text"!==d&&"json"!==d?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:o,config:e,request:h}),h=null}h.open(o.method.toUpperCase(),o.url,!0),h.timeout=o.timeout,"onloadend"in h?h.onloadend=g:h.onreadystatechange=function(){h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))&&setTimeout(g)},h.onabort=function(){h&&(n(new De("Request aborted",De.ECONNABORTED,e,h)),h=null)},h.onerror=function(){n(new De("Network Error",De.ERR_NETWORK,e,h)),h=null},h.ontimeout=function(){let t=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const s=o.transitional||Qe;o.timeoutErrorMessage&&(t=o.timeoutErrorMessage),n(new De(t,s.clarifyTimeoutError?De.ETIMEDOUT:De.ECONNABORTED,e,h)),h=null},void 0===s&&a.setContentType(null),"setRequestHeader"in h&&Le.forEach(a.toJSON(),(function(e,t){h.setRequestHeader(t,e)})),Le.isUndefined(o.withCredentials)||(h.withCredentials=!!o.withCredentials),d&&"json"!==d&&(h.responseType=o.responseType),m&&([c,u]=yt(m,!0),h.addEventListener("progress",c)),p&&h.upload&&([i,l]=yt(p),h.upload.addEventListener("progress",i),h.upload.addEventListener("loadend",l)),(o.cancelToken||o.signal)&&(r=t=>{h&&(n(!t||t.type?new gt(null,e,h):t),h.abort(),h=null)},o.cancelToken&&o.cancelToken.subscribe(r),o.signal&&(o.signal.aborted?r():o.signal.addEventListener("abort",r)));const v=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(o.url);v&&-1===ot.protocols.indexOf(v)?n(new De("Unsupported protocol "+v+":",De.ERR_BAD_REQUEST,e)):h.send(s||null)}))},Ot=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,o=new AbortController;const s=function(e){if(!n){n=!0,r();const t=e instanceof Error?e:this.reason;o.abort(t instanceof De?t:new gt(t instanceof Error?t.message:t))}};let a=t&&setTimeout((()=>{a=null,s(new De(`timeout ${t} of ms exceeded`,De.ETIMEDOUT))}),t);const r=()=>{e&&(a&&clearTimeout(a),a=null,e.forEach((e=>{e.unsubscribe?e.unsubscribe(s):e.removeEventListener("abort",s)})),e=null)};e.forEach((e=>e.addEventListener("abort",s)));const{signal:i}=o;return i.unsubscribe=()=>Le.asap(r),i}},Tt=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let o,s=0;for(;s<n;)o=s+t,yield e.slice(s,o),s=o},kt=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)break;yield n}}finally{await t.cancel()}},Bt=(e,t,n,o)=>{const s=async function*(e,t){for await(const n of kt(e))yield*Tt(n,t)}(e,t);let a,r=0,i=e=>{a||(a=!0,o&&o(e))};return new ReadableStream({async pull(e){try{const{done:t,value:o}=await s.next();if(t)return i(),void e.close();let a=o.byteLength;if(n){let e=r+=a;n(e)}e.enqueue(new Uint8Array(o))}catch(t){throw i(t),t}},cancel:e=>(i(e),s.return())},{highWaterMark:2})},jt="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,Lt=jt&&"function"==typeof ReadableStream,Dt=jt&&("function"==typeof TextEncoder?(Ut=new TextEncoder,e=>Ut.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var Ut;const Mt=(e,...t)=>{try{return!!e(...t)}catch(n){return!1}},Pt=Lt&&Mt((()=>{let e=!1;const t=new Request(ot.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),Ft=Lt&&Mt((()=>Le.isReadableStream(new Response("").body))),qt={stream:Ft&&(e=>e.body)};var It;jt&&(It=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((e=>{!qt[e]&&(qt[e]=Le.isFunction(It[e])?t=>t[e]():(t,n)=>{throw new De(`Response type '${e}' is not supported`,De.ERR_NOT_SUPPORT,n)})})));const zt=async(e,t)=>{const n=Le.toFiniteNumber(e.getContentLength());return null==n?(async e=>{if(null==e)return 0;if(Le.isBlob(e))return e.size;if(Le.isSpecCompliantForm(e)){const t=new Request(ot.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return Le.isArrayBufferView(e)||Le.isArrayBuffer(e)?e.byteLength:(Le.isURLSearchParams(e)&&(e+=""),Le.isString(e)?(await Dt(e)).byteLength:void 0)})(t):n},$t=jt&&(async e=>{let{url:t,method:n,data:o,signal:s,cancelToken:a,timeout:r,onDownloadProgress:i,onUploadProgress:c,responseType:l,headers:u,withCredentials:d="same-origin",fetchOptions:p}=Ct(e);l=l?(l+"").toLowerCase():"text";let m,f=Ot([s,a&&a.toAbortSignal()],r);const h=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let g;try{if(c&&Pt&&"get"!==n&&"head"!==n&&0!==(g=await zt(u,o))){let e,n=new Request(t,{method:"POST",body:o,duplex:"half"});if(Le.isFormData(o)&&(e=n.headers.get("content-type"))&&u.setContentType(e),n.body){const[e,t]=wt(g,yt(Et(c)));o=Bt(n.body,65536,e,t)}}Le.isString(d)||(d=d?"include":"omit");const s="credentials"in Request.prototype;m=new Request(t,{...p,signal:f,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:o,duplex:"half",credentials:s?d:void 0});let a=await fetch(m);const r=Ft&&("stream"===l||"response"===l);if(Ft&&(i||r&&h)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=a[t]}));const t=Le.toFiniteNumber(a.headers.get("content-length")),[n,o]=i&&wt(t,yt(Et(i),!0))||[];a=new Response(Bt(a.body,65536,n,(()=>{o&&o(),h&&h()})),e)}l=l||"text";let v=await qt[Le.findKey(qt,l)||"text"](a,e);return!r&&h&&h(),await new Promise(((t,n)=>{vt(t,n,{data:v,headers:mt.from(a.headers),status:a.status,statusText:a.statusText,config:e,request:m})}))}catch(v){if(h&&h(),v&&"TypeError"===v.name&&/fetch/i.test(v.message))throw Object.assign(new De("Network Error",De.ERR_NETWORK,e,m),{cause:v.cause||v});throw De.from(v,v&&v.code,e,m)}}),Gt={http:null,xhr:At,fetch:$t};Le.forEach(Gt,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(n){}Object.defineProperty(e,"adapterName",{value:t})}}));const Ht=e=>`- ${e}`,Wt=e=>Le.isFunction(e)||null===e||!1===e,Jt=e=>{e=Le.isArray(e)?e:[e];const{length:t}=e;let n,o;const s={};for(let a=0;a<t;a++){let t;if(n=e[a],o=n,!Wt(n)&&(o=Gt[(t=String(n)).toLowerCase()],void 0===o))throw new De(`Unknown adapter '${t}'`);if(o)break;s[t||"#"+a]=o}if(!o){const e=Object.entries(s).map((([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")));throw new De("There is no suitable adapter to dispatch the request "+(t?e.length>1?"since :\n"+e.map(Ht).join("\n"):" "+Ht(e[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return o};function Kt(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new gt(null,e)}function Qt(e){Kt(e),e.headers=mt.from(e.headers),e.data=ft.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return Jt(e.adapter||rt.adapter)(e).then((function(t){return Kt(e),t.data=ft.call(e,e.transformResponse,t),t.headers=mt.from(t.headers),t}),(function(t){return ht(t)||(Kt(e),t&&t.response&&(t.response.data=ft.call(e,e.transformResponse,t.response),t.response.headers=mt.from(t.response.headers))),Promise.reject(t)}))}const Xt="1.8.4",Yt={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{Yt[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const Zt={};Yt.transitional=function(e,n,o){function s(e,t){return"[Axios v1.8.4] Transitional option '"+e+"'"+t+(o?". "+o:"")}return(o,a,r)=>{if(!1===e)throw new De(s(a," has been removed"+(n?" in "+n:"")),De.ERR_DEPRECATED);return n&&!Zt[a]&&(Zt[a]=!0,t("warn","at node_modules/.store/axios@1.8.4/node_modules/axios/lib/helpers/validator.js:43",s(a," has been deprecated since v"+n+" and will be removed in the near future"))),!e||e(o,a,r)}},Yt.spelling=function(e){return(n,o)=>(t("warn","at node_modules/.store/axios@1.8.4/node_modules/axios/lib/helpers/validator.js:58",`${o} is likely a misspelling of ${e}`),!0)};const en={assertOptions:function(e,t,n){if("object"!=typeof e)throw new De("options must be an object",De.ERR_BAD_OPTION_VALUE);const o=Object.keys(e);let s=o.length;for(;s-- >0;){const a=o[s],r=t[a];if(r){const t=e[a],n=void 0===t||r(t,a,e);if(!0!==n)throw new De("option "+a+" must be "+n,De.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new De("Unknown option "+a,De.ERR_BAD_OPTION)}},validators:Yt},tn=en.validators;class nn{constructor(e){this.defaults=e,this.interceptors={request:new Ke,response:new Ke}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{n.stack?t&&!String(n.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+t):n.stack=t}catch(o){}}throw n}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=Rt(this.defaults,t);const{transitional:n,paramsSerializer:o,headers:s}=t;void 0!==n&&en.assertOptions(n,{silentJSONParsing:tn.transitional(tn.boolean),forcedJSONParsing:tn.transitional(tn.boolean),clarifyTimeoutError:tn.transitional(tn.boolean)},!1),null!=o&&(Le.isFunction(o)?t.paramsSerializer={serialize:o}:en.assertOptions(o,{encode:tn.function,serialize:tn.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),en.assertOptions(t,{baseUrl:tn.spelling("baseURL"),withXsrfToken:tn.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=s&&Le.merge(s.common,s[t.method]);s&&Le.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete s[e]})),t.headers=mt.concat(a,s);const r=[];let i=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(i=i&&e.synchronous,r.unshift(e.fulfilled,e.rejected))}));const c=[];let l;this.interceptors.response.forEach((function(e){c.push(e.fulfilled,e.rejected)}));let u,d=0;if(!i){const e=[Qt.bind(this),void 0];for(e.unshift.apply(e,r),e.push.apply(e,c),u=e.length,l=Promise.resolve(t);d<u;)l=l.then(e[d++],e[d++]);return l}u=r.length;let p=t;for(d=0;d<u;){const e=r[d++],t=r[d++];try{p=e(p)}catch(m){t.call(this,m);break}}try{l=Qt.call(this,p)}catch(m){return Promise.reject(m)}for(d=0,u=c.length;d<u;)l=l.then(c[d++],c[d++]);return l}getUri(e){return Je(xt((e=Rt(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}Le.forEach(["delete","get","head","options"],(function(e){nn.prototype[e]=function(t,n){return this.request(Rt(n||{},{method:e,url:t,data:(n||{}).data}))}})),Le.forEach(["post","put","patch"],(function(e){function t(t){return function(n,o,s){return this.request(Rt(s||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:o}))}}nn.prototype[e]=t(),nn.prototype[e+"Form"]=t(!0)}));const on=nn;class sn{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const o=new Promise((e=>{n.subscribe(e),t=e})).then(e);return o.cancel=function(){n.unsubscribe(t)},o},e((function(e,o,s){n.reason||(n.reason=new gt(e,o,s),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new sn((function(t){e=t})),cancel:e}}}const an=sn;const rn={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(rn).forEach((([e,t])=>{rn[t]=e}));const cn=rn;const ln=function e(t){const n=new on(t),o=J(on.prototype.request,n);return Le.extend(o,on.prototype,n,{allOwnKeys:!0}),Le.extend(o,n,null,{allOwnKeys:!0}),o.create=function(n){return e(Rt(t,n))},o}(rt);ln.Axios=on,ln.CanceledError=gt,ln.CancelToken=an,ln.isCancel=ht,ln.VERSION=Xt,ln.toFormData=ze,ln.AxiosError=De,ln.Cancel=ln.CanceledError,ln.all=function(e){return Promise.all(e)},ln.spread=function(e){return function(t){return e.apply(null,t)}},ln.isAxiosError=function(e){return Le.isObject(e)&&!0===e.isAxiosError},ln.mergeConfig=Rt,ln.AxiosHeaders=mt,ln.formToJSON=e=>st(Le.isHTMLForm(e)?new FormData(e):e),ln.getAdapter=Jt,ln.HttpStatusCode=cn,ln.default=ln;const un=ln,dn={__name:"VoiceAssistant",setup(n){const o=i(),s="https://api.yourdomain.com/speech-recognition",a="https://api.yourdomain.com/wakeup-detection",r="https://api.yourdomain.com/text-to-speech",c="your-api-key",l=e.computed((()=>o.state.chatMessages)),u=e.ref(""),d=e.ref(!1),p=e.ref(!1),m=e.ref(0),f=e.ref(null),h=e.ref(!1),g=e.ref(!1);let v=null,y=null,w=null,E=null;const b=e.computed((()=>g.value?"已唤醒，请说出指令":d.value?"正在聆听...":h.value?"等待唤醒":"待命中")),_=async e=>{t("log","at components/VoiceAssistant.vue:205","检查唤醒词..."),uni.showLoading({title:"检测中..."});try{const n=new FormData;n.append("audio",{uri:e,type:"audio/mp3",name:"voice.mp3"}),n.append("wake_word","小源小源");const o=await un.post(a,n,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${c}`}});uni.hideLoading(),o.data&&o.data.detected?(t("log","at components/VoiceAssistant.vue:229","检测到唤醒词!"),x()):(t("log","at components/VoiceAssistant.vue:232","未检测到唤醒词，继续等待"),h.value&&(g.value=!1))}catch(n){uni.hideLoading(),t("error","at components/VoiceAssistant.vue:239","唤醒词检测失败:",n),uni.showToast({title:"唤醒词检测失败",icon:"none"}),h.value&&(g.value=!1)}},N=async e=>{t("log","at components/VoiceAssistant.vue:254","执行语音识别..."),uni.showLoading({title:"识别中..."});try{const n=new FormData;n.append("audio",{uri:e,type:"audio/mp3",name:"voice.mp3"}),n.append("language","zh-CN");const o=await un.post(s,n,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${c}`}});if(uni.hideLoading(),o.data&&o.data.text){const e=o.data.text.trim();t("log","at components/VoiceAssistant.vue:279","识别结果:",e),e?(u.value=e,setTimeout((()=>{C()}),300)):uni.showToast({title:"未能识别语音内容",icon:"none"})}else uni.showToast({title:"语音识别失败",icon:"none"})}catch(n){uni.hideLoading(),t("error","at components/VoiceAssistant.vue:303","语音识别请求失败:",n),uni.showToast({title:"语音识别失败",icon:"none"})}},V=async e=>{if(e){t("log","at components/VoiceAssistant.vue:314","播放语音:",e);try{const t=await un.post(r,{text:e,voice:"zh-CN-XiaoxiaoNeural",speed:1},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},responseType:"blob"}),n=new Blob([t.data],{type:"audio/mp3"}),o=URL.createObjectURL(n);if(w)w.src=o,w.play();else{new Audio(o).play()}}catch(n){t("error","at components/VoiceAssistant.vue:344","文字转语音失败:",n),uni.showToast({title:"语音播放失败",icon:"none"})}}},x=()=>{g.value=!0,V("我在，请说"),setTimeout((()=>{A()}),1e3)},S=()=>{h.value=!h.value,h.value?(uni.showToast({title:'唤醒模式已开启，请说"小源小源"',icon:"none",duration:2e3}),t("log","at components/VoiceAssistant.vue:375",'唤醒模式已开启，等待唤醒词"小源小源"')):(uni.showToast({title:"唤醒模式已关闭",icon:"none",duration:1500}),g.value=!1,t("log","at components/VoiceAssistant.vue:383","唤醒模式已关闭"))},R=e=>{if(!e)return"";try{if(e.includes(":")){const t=e.split(":");return t.length>=3?`${t[0]}:${t[1]}:${t[2].substring(0,2)}`:e}return new Date(e).toTimeString().substring(0,8)}catch(t){return e}},C=async()=>{if(u.value.trim()&&!d.value)try{p.value=!0,await o.dispatch("sendAIMessage",u.value);const t=o.state.chatMessages,n=t[t.length-1];n&&"assistant"===n.role&&V(n.content),u.value="",setTimeout((()=>{p.value=!1,e.nextTick((()=>{T()}))}),500),g.value&&(g.value=!1)}catch(n){t("error","at components/VoiceAssistant.vue:445","发送消息失败:",n),p.value=!1,uni.showToast({title:"发送消息失败",icon:"none"})}},A=()=>{if(!y)return t("warn","at components/VoiceAssistant.vue:457","录音功能不可用"),void uni.showToast({title:"录音功能不可用",icon:"none"});d.value=!0,v=setTimeout((()=>{O()}),1e4);try{y.start({duration:1e4,sampleRate:16e3,numberOfChannels:1,encodeBitRate:48e3,format:"mp3",frameSize:50}),t("log","at components/VoiceAssistant.vue:482","开始录音")}catch(e){t("error","at components/VoiceAssistant.vue:484","启动录音失败:",e),d.value=!1,uni.showToast({title:"启动录音失败",icon:"none"})}},O=()=>{if(v&&(clearTimeout(v),v=null),d.value){try{y&&(y.stop(),t("log","at components/VoiceAssistant.vue:505","停止录音"))}catch(e){t("error","at components/VoiceAssistant.vue:508","停止录音失败:",e),uni.showToast({title:"停止录音失败",icon:"none"})}d.value=!1}},T=()=>{m.value=999999,setTimeout((()=>{m.value=999999}),100)},k=()=>{t("log","at components/VoiceAssistant.vue:532","加载更多消息")};return e.watch(l,(()=>{e.nextTick((()=>{T()}))})),e.onMounted((()=>{(()=>{try{uni.getRecorderManager&&(y=uni.getRecorderManager(),y.onStart((()=>{t("log","at components/VoiceAssistant.vue:157","录音开始")})),y.onStop((e=>{t("log","at components/VoiceAssistant.vue:161","录音结束",e);const{tempFilePath:n}=e;E=n,h.value&&!g.value?_(n):N(n)})),y.onError((e=>{t("error","at components/VoiceAssistant.vue:175","录音错误:",e),d.value=!1,uni.showToast({title:"录音出错，请重试",icon:"none"})}))),uni.createInnerAudioContext&&(w=uni.createInnerAudioContext(),w.onError((e=>{t("error","at components/VoiceAssistant.vue:189","音频播放错误:",e),uni.showToast({title:"语音播放失败",icon:"none"})}))),t("log","at components/VoiceAssistant.vue:197","语音服务初始化成功")}catch(e){t("error","at components/VoiceAssistant.vue:199","初始化语音服务失败:",e)}})(),l.value.length>0&&e.nextTick((()=>{T()}))})),e.onBeforeUnmount((()=>{if(v&&(clearTimeout(v),v=null),y)try{y.stop()}catch(e){}w&&w.stop()})),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"voice-assistant"},[e.createElementVNode("view",{class:"panel-header"},[e.createElementVNode("text",{class:"panel-title"},"语音助手"),e.createElementVNode("view",{class:e.normalizeClass(["assistant-status",{active:d.value,wakeup:g.value}])},[e.createElementVNode("view",{class:"status-dot"}),e.createElementVNode("text",{class:"status-text"},e.toDisplayString(e.unref(b)),1)],2)]),e.createElementVNode("view",{class:"chat-container"},[e.createElementVNode("scroll-view",{"scroll-y":"",class:"chat-messages","scroll-top":m.value,onScrolltoupper:k,ref_key:"messagesScroll",ref:f,"enable-flex":""},[e.createElementVNode("view",{class:"scroll-content"},[0===e.unref(l).length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("view",{class:"empty-icon"}),e.createElementVNode("text",{class:"empty-text"},"您可以通过语音或文字与我交流"),e.createElementVNode("view",{class:"examples"},[e.createElementVNode("text",{class:"example-title"},"您可以尝试:"),e.createElementVNode("view",{class:"example-item"},[e.createElementVNode("view",{class:"example-bullet"}),e.createElementVNode("text",{class:"example-text"},'"打开水泵"')]),e.createElementVNode("view",{class:"example-item"},[e.createElementVNode("view",{class:"example-bullet"}),e.createElementVNode("text",{class:"example-text"},'"关闭所有设备"')]),e.createElementVNode("view",{class:"example-item"},[e.createElementVNode("view",{class:"example-bullet"}),e.createElementVNode("text",{class:"example-text"},'"切换到自动模式"')])])])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"messages-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),((t,n)=>(e.openBlock(),e.createElementBlock("view",{key:n,class:e.normalizeClass(["message-item",{user:"user"===t.role,assistant:"assistant"===t.role,system:"system"===t.role}])},[e.createElementVNode("view",{class:e.normalizeClass(["message-avatar",t.role])},[e.createElementVNode("view",{class:"avatar-icon"})],2),e.createElementVNode("view",{class:"message-content"},[e.createElementVNode("view",{class:"message-bubble"},e.toDisplayString(t.content),1),e.createElementVNode("text",{class:"message-time"},e.toDisplayString(R(t.time)),1)])],2)))),128)),p.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"typing-indicator"},[e.createElementVNode("view",{class:"typing-dot"}),e.createElementVNode("view",{class:"typing-dot"}),e.createElementVNode("view",{class:"typing-dot"})])):e.createCommentVNode("",!0)]))])],40,["scroll-top"])]),e.createElementVNode("view",{class:"chat-input-container"},[e.createElementVNode("view",{class:"input-wrapper"},[e.withDirectives(e.createElementVNode("input",{class:"text-input",type:"text","onUpdate:modelValue":n[0]||(n[0]=e=>u.value=e),placeholder:"请输入您的问题...",onConfirm:C,disabled:d.value,"adjust-position":"false"},null,40,["disabled"]),[[e.vModelText,u.value]])]),e.createElementVNode("view",{class:e.normalizeClass(["voice-btn",{listening:d.value,wakeup:h.value}]),onTouchstart:A,onTouchend:O,onClick:S},[e.createElementVNode("view",{class:"voice-icon"}),d.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"voice-waves"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(3,((t,n)=>e.createElementVNode("view",{key:n,class:"wave"}))),64))])):e.createCommentVNode("",!0)],34),e.createElementVNode("button",{class:"send-btn",disabled:!u.value||d.value,onClick:C},[e.createElementVNode("view",{class:"send-icon"})],8,["disabled"])])]))}},pn=$(dn,[["__scopeId","data-v-a7d6f707"]]),mn=$({__name:"Loading",props:{show:{type:Boolean,default:!1},text:{type:String,default:""}},setup:t=>(n,o)=>t.show?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("view",{class:"loading-overlay"}),e.createElementVNode("view",{class:"loading-content"},[e.createElementVNode("view",{class:"loading-spinner"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(4,((t,n)=>e.createElementVNode("view",{key:n,class:e.normalizeClass(["spinner-item",`delay-${n}`])},null,2))),64))]),e.createElementVNode("text",{class:"loading-text"},e.toDisplayString(t.text||"加载中..."),1)])])):e.createCommentVNode("",!0)},[["__scopeId","data-v-c0d7a97a"]]);__definePage("pages/index/index",{__name:"index",setup(t){const n=i(),o=e.computed((()=>n.getters.isAutoMode)),s=e.computed((()=>n.state.currentRule)),a=e.computed((()=>n.state.loading)),r=e.ref(!1),c=e.ref(""),l=()=>{var e;c.value?(e=c.value,B.value=e,uni.showToast({title:"服务器地址已更新",icon:"success"}),r.value=!1,n.dispatch("initApp")):uni.showToast({title:"请输入有效地址",icon:"none"})};return e.onMounted((()=>{c.value=B.value,n.dispatch("initApp"),"android"===uni.getSystemInfoSync().platform&&setTimeout((()=>{"undefined"!=typeof plus&&plus.navigator&&plus.navigator.setFullscreen(!0)}),1e3)})),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"app-info"},[e.createElementVNode("text",{class:"app-title"},"开源节流-智能灌溉控制系统"),e.createElementVNode("text",{class:"app-subtitle"},"MYL")]),e.createElementVNode("view",{class:"status-bar"},[e.createElementVNode("view",{class:"status-item"},[e.createElementVNode("text",{class:"status-label"},"模式"),e.createElementVNode("text",{class:e.normalizeClass(["status-value",{auto:e.unref(o)}])},e.toDisplayString(e.unref(o)?"自动":"手动"),3)]),e.createElementVNode("view",{class:"status-item"},[e.createElementVNode("text",{class:"status-label"},"当前规则"),e.createElementVNode("text",{class:"status-value rule"},e.toDisplayString(e.unref(s)||"未设置"),1)]),e.createElementVNode("view",{class:"status-item settings"},[e.createElementVNode("view",{class:"setting-btn",onClick:n[0]||(n[0]=e=>r.value=!0)},[e.createElementVNode("view",{class:"setting-icon ip"}),e.createElementVNode("text",null,"修改IP")])])])]),e.createElementVNode("view",{class:"main-content"},[e.createElementVNode("view",{class:"left-panel"},[e.createVNode(pn)]),e.createElementVNode("view",{class:"center-panel"},[e.createVNode(G)]),e.createElementVNode("view",{class:"right-panel"},[e.createElementVNode("view",{class:"top-section"},[e.createVNode(H)]),e.createElementVNode("view",{class:"bottom-section"},[e.createVNode(W)])])]),r.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"dialog-overlay",onClick:n[4]||(n[4]=e=>r.value=!1)},[e.createElementVNode("view",{class:"dialog-content",onClick:n[3]||(n[3]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("text",{class:"dialog-title"},"修改服务器地址"),e.withDirectives(e.createElementVNode("input",{class:"dialog-input",type:"text","onUpdate:modelValue":n[1]||(n[1]=e=>c.value=e),placeholder:"请输入新的服务器地址"},null,512),[[e.vModelText,c.value]]),e.createElementVNode("view",{class:"dialog-actions"},[e.createElementVNode("button",{class:"dialog-btn cancel",onClick:n[2]||(n[2]=e=>r.value=!1)},"取消"),e.createElementVNode("button",{class:"dialog-btn confirm",onClick:l},"确认")])])])):e.createCommentVNode("",!0),e.createVNode(mn,{show:e.unref(a)},null,8,["show"])]))}});const fn={onLaunch:function(){t("log","at App.vue:4","App Launch"),this.setFullScreen()},onShow:function(){t("log","at App.vue:11","App Show"),this.setFullScreen()},onHide:function(){t("log","at App.vue:18","App Hide")},methods:{setFullScreen(){setTimeout((()=>{if("undefined"!=typeof plus)try{plus.screen.lockOrientation("landscape"),plus.navigator.setFullscreen(!0);const e=plus.webview.currentWebview();if(e.setStyle({position:"absolute",top:"0px",bottom:"0px",left:"0px",right:"0px",background:"#051020",popGesture:"none",scrollIndicator:"none",softinputMode:"adjustResize"}),plus.navigator.setStatusBarBackground("#000000"),plus.navigator.setStatusBarStyle("dark"),plus.navigator.setFullscreen(!0),"android"===plus.os.name.toLowerCase()){plus.android.importClass("android.content.Context");const e=plus.android.runtimeMainActivity().getWindow(),t=(plus.android.importClass("android.view.View"),1024);e.setFlags(t,t);const n=e.getDecorView(),o=2|4|4096|256|512|1024;n.setSystemUiVisibility(o)}else if("ios"===plus.os.name.toLowerCase()){const t=plus.navigator.getStatusbarHeight();e.setStyle({top:-t+"px",bottom:"0px"})}}catch(e){t("error","at App.vue:94","设置全屏失败:",e.message)}}),300)}}},hn=new T({state:{devices:{pump:"off",nitrogen:"off",phosphorus:"off",potassium:"off"},currentMode:"manual",currentRule:"",allRules:[],loading:!1,chatMessages:[],requestStatus:{success:!1,message:""}},mutations:{updateDeviceStatus(e,{device:t,status:n}){e.devices[t]=n},updateCurrentMode(e,t){e.currentMode=t},updateCurrentRule(e,t){e.currentRule=t},updateAllRules(e,t){e.allRules=t},setLoading(e,t){e.loading=t},addChatMessage(e,{role:t,content:n}){e.chatMessages.push({role:t,content:n,time:(new Date).toLocaleTimeString()})},updateRequestStatus(e,{success:t,message:n}){e.requestStatus={success:t,message:n},setTimeout((()=>{e.requestStatus={success:!1,message:""}}),3e3)}},actions:{async initApp({dispatch:e}){await e("fetchCurrentMode"),await e("fetchAllDevicesStatus"),await e("fetchCurrentRule"),await e("fetchAllRules")},async fetchAllDevicesStatus({commit:e},n=!1){n||e("setLoading",!0);try{const t=["pump","nitrogen","phosphorus","potassium"];for(const n of t){const t=await L(n);0===t.code&&e("updateDeviceStatus",{device:n,status:t.data.status})}}catch(o){t("error","at store/index.js:90","获取设备状态失败",o),n||e("updateRequestStatus",{success:!1,message:"获取设备状态失败"})}finally{n||e("setLoading",!1)}},async fetchDeviceStatus({commit:e},{device:n,silent:o=!1}){o||e("setLoading",!0);try{const t=await L(n);return 0===t.code&&e("updateDeviceStatus",{device:n,status:t.data.status}),t}catch(s){throw t("error","at store/index.js:114",`获取${n}状态失败`,s),o||e("updateRequestStatus",{success:!1,message:`获取${n}状态失败`}),s}finally{o||e("setLoading",!1)}},async setDeviceStatus({commit:e,state:n},{device:o,status:s}){if("auto"!==n.currentMode){e("setLoading",!0);try{const t=await D(o,s);if(0===t.code){let n=!1,a="";"on"!==s||1!==t.data.set_on&&2!==t.data.set_on?"off"!==s||1!==t.data.set_off&&2!==t.data.set_off?a="设置失败":(n=!0,a=2===t.data.set_off?"设备已处于关闭状态":"设备关闭成功",e("updateDeviceStatus",{device:o,status:"off"})):(n=!0,a=2===t.data.set_on?"设备已处于开启状态":"设备开启成功",e("updateDeviceStatus",{device:o,status:"on"})),e("updateRequestStatus",{success:n,message:a})}else e("updateRequestStatus",{success:!1,message:t.message||"设置失败"});return t}catch(a){throw t("error","at store/index.js:161",`设置${o}状态失败`,a),e("updateRequestStatus",{success:!1,message:`设置${o}状态失败`}),a}finally{e("setLoading",!1)}}else e("updateRequestStatus",{success:!1,message:"自动模式下无法手动控制设备"})},async fetchCurrentMode({commit:e},n=!1){n||e("setLoading",!0);try{const t=await I();return 0===t.code&&e("updateCurrentMode",t.data.mod),t}catch(o){throw t("error","at store/index.js:182","获取当前模式失败",o),n||e("updateRequestStatus",{success:!1,message:"获取当前模式失败"}),o}finally{n||e("setLoading",!1)}},async setMode({commit:e},n){e("setLoading",!0);try{const t=await q(n);if(0===t.code){let o=!1,s="";1===t.data.setMod||2===t.data.setMod?(o=!0,s=2===t.data.setMod?`已处于${"auto"===n?"自动":"手动"}模式`:`切换到${"auto"===n?"自动":"手动"}模式成功`,e("updateCurrentMode",n)):s="模式设置失败",e("updateRequestStatus",{success:o,message:s})}else e("updateRequestStatus",{success:!1,message:t.message||"模式设置失败"});return t}catch(o){throw t("error","at store/index.js:218","设置模式失败",o),e("updateRequestStatus",{success:!1,message:"设置模式失败"}),o}finally{e("setLoading",!1)}},async fetchCurrentRule({commit:e},n=!1){n||e("setLoading",!0);try{const t=await U();return 0===t.code&&e("updateCurrentRule",t.data.rules),t}catch(o){throw t("error","at store/index.js:239","获取当前规则失败",o),n||e("updateRequestStatus",{success:!1,message:"获取当前规则失败"}),o}finally{n||e("setLoading",!1)}},async setRule({commit:e},n){e("setLoading",!0);try{const t=await M(n);if(0===t.code){let o=!1,s="";1===t.data.setRules||2===t.data.setRules?(o=!0,s=2===t.data.setRules?`已使用"${n}"规则`:`切换到"${n}"规则成功`,e("updateCurrentRule",n)):s="规则设置失败",e("updateRequestStatus",{success:o,message:s})}else e("updateRequestStatus",{success:!1,message:t.message||"规则设置失败"});return t}catch(o){throw t("error","at store/index.js:275","设置规则失败",o),e("updateRequestStatus",{success:!1,message:"设置规则失败"}),o}finally{e("setLoading",!1)}},async fetchAllRules({commit:e},n=!1){n||e("setLoading",!0);try{const t=await F();return 0===t.code&&e("updateAllRules",t.data),t}catch(o){throw t("error","at store/index.js:296","获取所有规则失败",o),n||e("updateRequestStatus",{success:!1,message:"获取所有规则失败"}),o}finally{n||e("setLoading",!1)}},async addRule({commit:e,dispatch:n},o){e("setLoading",!0);try{const t=await P(o);if(0===t.code)e("updateRequestStatus",{success:!0,message:"添加规则成功"}),await n("fetchAllRules");else{let n="添加规则失败";2===t.code?n="该植物规则已存在":3===t.code&&(n="起始时间不能大于结束时间"),e("updateRequestStatus",{success:!1,message:n})}return t}catch(s){throw t("error","at store/index.js:329","添加规则失败",s),e("updateRequestStatus",{success:!1,message:"添加规则失败"}),s}finally{e("setLoading",!1)}},async sendAIMessage({commit:e},n){e("addChatMessage",{role:"user",content:n}),e("setLoading",!0);try{const t=await z(n);if(0===t.code){e("addChatMessage",{role:"assistant",content:t.data.content});try{const n=t.data.content,o=JSON.parse(n);if("set_device_status"===o.function_name){const{device:t,status:n}=o.parameters;Array.isArray(t)?e("addChatMessage",{role:"system",content:`正在执行批量${"on"===n?"开启":"关闭"}设备操作...`}):e("addChatMessage",{role:"system",content:`正在${"on"===n?"开启":"关闭"}${t}...`})}}catch(o){}}else e("updateRequestStatus",{success:!1,message:"发送消息失败"});return t}catch(s){throw t("error","at store/index.js:380","发送消息失败",s),e("updateRequestStatus",{success:!1,message:"发送消息失败"}),s}finally{e("setLoading",!1)}}},getters:{isAutoMode:e=>"auto"===e.currentMode,deviceList:e=>Object.entries(e.devices).map((([e,t])=>({id:e,name:{pump:"水泵",nitrogen:"氮肥",phosphorus:"磷肥",potassium:"钾肥"}[e],status:t})))}});const{app:gn,Vuex:vn,Pinia:yn}=function(){const n=e.createVueApp(fn);return n.use(hn),n.config.globalProperties.$autoAdjustStatusBar=!1,n.config.errorHandler=(e,n,o)=>{t("error","at main.js:16","应用错误:",e,o)},n.config.globalProperties.$setFullScreen=()=>{if("undefined"!=typeof plus){plus.navigator.setFullscreen(!0);const n=plus.webview.currentWebview();if(n&&n.setStyle({popGesture:"none",background:"#051020"}),"android"===plus.os.name.toLowerCase())try{const e=plus.android.runtimeMainActivity().getWindow(),t=(plus.android.importClass("android.view.View"),e.getDecorView()),n=5894;t.setSystemUiVisibility(n)}catch(e){t("error","at main.js:50","Android全屏设置失败:",e)}}},{app:n}}();uni.Vuex=vn,uni.Pinia=yn,gn.provide("__globalStyles",__uniConfig.styles),gn._component.mpType="app",gn._component.render=()=>{},gn.mount("#app")}(Vue);
